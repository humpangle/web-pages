<!DOCTYPE html> <html lang=en style><!--
 Page saved with SingleFile 
 url: https://www.crustofcode.com/how4/ 
 saved date: Wed Aug 07 2024 07:40:46 GMT-0400 (Eastern Daylight Time)
--><meta charset=utf-8>
<title>The How of Macros 4: `quote`</title>
<meta http-equiv=X-UA-Compatible content="IE=edge">
<meta name=HandheldFriendly content=True>
<meta name=viewport content="width=device-width, initial-scale=1.0">
<style>a,article,aside,body,code,div,em,footer,h1,h2,h3,h4,header,html,iframe,li,nav,ol,p,pre,section,span,strong,time,ul{border:0;font:inherit;font-size:100%;margin:0;padding:0;vertical-align:baseline}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;box-sizing:border-box;font-family:sans-serif}*,:after,:before{box-sizing:inherit}a{background-color:transparent}a:active,a:hover{outline:0}strong{font-weight:700}em{font-style:italic}svg:not(:root){overflow:hidden}code{font-family:monospace,monospace;font-size:1em}@media (max-width:600px){}button{color:inherit;font:inherit;margin:0}button{overflow:visible}button{text-transform:none}button{-webkit-appearance:button}html{-webkit-tap-highlight-color:rgba(0,0,0,0);font-size:62.5%}body{text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-moz-font-feature-settings:"liga"on;background:#fff;color:var(--color-darkgrey);font-family:var(--font-sans);font-size:1.6rem;font-style:normal;font-weight:400;letter-spacing:0;line-height:1.6em}::selection{background:#daf2fd;text-shadow:none}hr{border:0;border-top:1px solid #f0f0f0;display:block;height:1px;margin:2.5em 0 3.5em;padding:0;width:100%}iframe,svg{vertical-align:middle}ol,ul{padding-left:1.3em;padding-right:1.5em}ol,ul{max-width:100%}li{line-height:1.6em;padding-left:.3em}li+li{margin-top:.5em}a{color:#15171a;text-decoration:none}h1,h2,h3,h4{text-rendering:optimizeLegibility;letter-spacing:-.01em;line-height:1.15;margin-top:0}h1{letter-spacing:-.015em;margin:0 0 .5em}@media (max-width:600px){h1{font-size:2.8rem}}@media (max-width:600px){h2{font-size:2.3rem}}h3{font-size:2.4rem;font-weight:600}@media (max-width:600px){h3{font-size:1.7rem}}@media (max-width:600px){h4{font-size:1.7rem}}:root{--color-green:#a4d037;--color-yellow:#fecd35;--color-red:#f05230;--color-darkgrey:#15171a;--color-midgrey:#738a94;--color-lightgrey:#f1f1f1;--color-secondary-text:#979797;--color-border:#e1e1e1;--color-wash:#e5eff5;--color-darkmode:#151719;--font-sans:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;--font-serif:Georgia,Times,serif;--font-mono:Menlo,Courier,monospace}.viewport{display:flex;flex-direction:column;min-height:100vh;position:relative}.site-content{flex-grow:1}.outer{padding:0 max(4vmin,20px);position:relative}.inner{margin:0 auto;max-width:1200px;width:100%}@media (min-width:992px){}@media (max-width:991px){}@media (max-width:767px){}.gh-head{background-color:#fff;font-size:1.6rem;height:88px;line-height:1.3em;z-index:150}.has-cover:not(.home-template) .gh-head{background-color:var(--ghost-accent-color);color:#fff}:is(.home-template,.paged:not(.tag-template):not(.author-template)).has-cover .gh-head{background-color:transparent;color:#fff;left:0;position:absolute;right:0;top:0;z-index:2000}.gh-head a{text-decoration:none}.gh-head-inner{align-items:center;-moz-column-gap:40px;column-gap:40px;display:grid;grid-auto-flow:row dense;height:100%}.is-head-left-logo .gh-head-inner{grid-template-columns:auto 1fr auto}@media (min-width:992px){.is-head-left-logo .gh-head-menu{margin-left:16px;margin-right:64px}}@media (min-width:992px){}@media (min-width:992px){}.gh-head-brand{align-items:center;display:flex;height:40px;word-break:break-all}.gh-head-logo{display:block;font-size:2.6rem;font-weight:800;letter-spacing:-.02em;white-space:nowrap}.gh-head-logo.no-image{margin-top:-5px}.has-cover .gh-head-logo{color:#fff}.gh-head-menu{align-items:center;display:flex;font-weight:500;margin-top:1px}.gh-head-menu .nav{align-items:center;display:inline-flex;flex-wrap:wrap;gap:32px;list-style:none;margin:0;padding:0}.gh-head-menu .nav li{margin:0;padding:0}.gh-head-menu .nav a{color:inherit;display:inline-block;line-height:1.7}.gh-head-menu .nav a:hover{opacity:.9}@media (min-width:992px){body:not(.is-dropdown-loaded) .gh-head-menu .nav>li{opacity:0}}.gh-head-actions{align-items:center;display:flex;gap:24px;justify-content:flex-end;list-style:none;text-align:right}.gh-head-members{align-items:center;display:flex;gap:20px}.gh-head-link{color:inherit;font-weight:500}.gh-head-button{align-items:center;border-radius:48px;display:inline-flex;font-size:1.6rem;font-weight:600;height:44px;justify-content:center;letter-spacing:-.005em;padding:8px 20px}.has-cover .gh-head-button{background:#fff;color:var(--color-darkgrey)}@media (max-width:767px){.gh-head-members{flex-direction:column-reverse;gap:16px;width:100%}}.gh-search{align-items:center;background-color:transparent;border:0;cursor:pointer;display:inline-flex;height:32px;justify-content:center;outline:none;padding:0;width:32px}.gh-search:hover{opacity:.9}.gh-head-actions .gh-search{margin-right:-4px}@media (max-width:767px){.gh-head-actions .gh-search{display:none}}@media (min-width:768px){}@media (max-width:767px){#gh-head{height:64px}#gh-head .gh-head-inner{gap:48px;grid-template-columns:1fr;grid-template-rows:auto 1fr auto}#gh-head .gh-head-brand{align-items:center;display:grid;grid-column-start:1;grid-template-columns:1fr auto auto;height:64px}#gh-head .gh-head-logo{font-size:2.2rem}#gh-head .gh-head-actions,#gh-head .gh-head-menu{justify-content:center;opacity:0;position:fixed;visibility:hidden}#gh-head .gh-head-menu{margin:0;transform:translateY(0);transition:none}#gh-head .nav{align-items:center;gap:16px;line-height:1.4}#gh-head .nav a{font-size:2.6rem;font-weight:600;text-transform:none}#gh-head .nav li{opacity:0;transform:translateY(-4px)}#gh-head :is(.gh-head-button,.gh-head-link){opacity:0;transform:translateY(8px)}#gh-head .gh-head-button{font-size:1.8rem;opacity:0;text-transform:none;transform:translateY(8px);width:100%}}@media (max-width:991px){}@media (max-width:767px){}.post-card{background-size:cover;display:flex;flex-direction:column;grid-column:span 2;position:relative;word-break:break-word}.post-card-content-link{color:var(--color-darkgrey);display:block;position:relative}.post-card-content-link:hover{text-decoration:none}.no-image .post-card-header{margin-top:0}.post-card-tags{align-items:center;color:var(--color-secondary-text);display:flex;font-weight:600;gap:12px;letter-spacing:-.005em;line-height:1;margin:0 0 10px}.post-card-title{font-size:2.6rem;font-weight:800;line-height:1.2;margin:0}.post-card-content-link:hover .post-card-title{opacity:.9}.no-image .post-card-title{margin-top:0}.post-card-content{display:flex;flex-direction:column;flex-grow:1}.post-card-excerpt{-webkit-line-clamp:3;-webkit-box-orient:vertical;display:-webkit-box;font-size:1.6rem;line-height:1.5;margin-top:12px;max-width:720px;overflow-y:hidden;word-break:break-word}.post-card:not(.post-card-large):not(.post-card-full):not(.dynamic):not(.no-image) .post-card-excerpt{-webkit-line-clamp:2}:is(.tag-template,.author-template) .post-card-excerpt{margin-top:6px}.post-card-meta{color:var(--color-secondary-text);font-size:1.3rem;margin-top:12px;padding:0}.post-card-meta,.post-card-meta>*{align-items:center;display:flex;gap:6px}.post-card-meta>*+:not(script):before{background-color:var(--color-secondary-text);border-radius:50%;content:"";height:2px;width:2px}.author-profile-image{background:#fff;-o-object-fit:cover;object-fit:cover}.author-list{display:flex;flex-wrap:wrap;list-style:none;margin:0 0 0 4px}.author-list-item{flex-shrink:0;margin:0;padding:0;position:relative}@media (min-width:1001px){}@media (max-width:767px){}.article{word-break:break-word}.post-template .article{padding:max(8vmin,40px)0 max(8vmin,64px)}.post-template .article-header{padding:0 0 max(6.4vmin,40px)}.article-tag{font-size:1.6rem;margin-bottom:16px}.article-tag a{color:var(--color-secondary-text)}.article-title{color:var(--color-darkgrey);font-size:clamp(3.2rem,5vw,5.2rem);font-weight:800;line-height:1.05;margin-bottom:0}@media (max-width:767px){}.gh-canvas{--gap:max(4vmin,20px);--main:min(var(--content-width,720px),100% - var(--gap)*2);--wide:minmax(0,calc((var(--container-width,1200px) - var(--content-width,720px))/2));--full:minmax(var(--gap),1fr);display:grid;grid-template-columns:[full-start]var(--full)[wide-start]var(--wide)[main-start]var(--main)[main-end]var(--wide)[wide-end]var(--full)[full-end]}.gh-canvas>*{grid-column:main-start/main-end}.gh-content>*+*{margin-bottom:0;margin-top:max(3.2vmin,24px)}.gh-content>[id]{color:var(--color-darkgrey);margin:0}.gh-content>[id]:not(:first-child){margin:2em 0 0}.gh-content>[id]+*{margin-top:1.5rem!important}.gh-content>hr{margin-top:max(4.8vmin,32px);position:relative}.gh-content>hr+*{margin-top:max(4.8vmin,32px)!important}.gh-content a{color:var(--ghost-accent-color);text-decoration:underline;word-break:break-word}.gh-content>ol,.gh-content>p{font-family:var(--font-serif);font-size:2rem;font-weight:400;line-height:1.6em}.gh-content>ol{padding-left:1.9em}.gh-content :not(pre)>code{background:#f0f6f9;border:1px solid #e1eaef;border-radius:.25em;color:#15171a;font-size:.9em;font-weight:400!important;line-height:1em;padding:.15em .4em;vertical-align:middle}.gh-content pre{box-shadow:0 2px 6px -2px rgba(0,0,0,.1),0 0 1px rgba(0,0,0,.4)}@media (max-width:650px){.gh-content>ol,.gh-content>p{font-size:1.8rem}}.article-byline{display:flex;justify-content:space-between;margin:min(24px,5.6vmin)0 0}.article-byline-content{align-items:center;display:flex;flex-grow:1}.article-byline-content .author-list{justify-content:flex-start;padding:0 14px 0 0}.article-byline-meta{color:var(--color-secondary-text);font-size:1.4rem;line-height:1.2em}.article-byline-meta .author-name{font-size:1.7rem;font-weight:700;letter-spacing:0;margin:0 0 6px}.article-byline-meta .bull{display:inline-block;margin:0 2px}.author-avatar{background-color:var(--color-border);border:2px solid #fff;border-radius:50%;display:block;height:min(56px,13.6vmin);margin:0-4px;overflow:hidden;width:min(56px,13.6vmin)}@media (max-width:767px){.article-byline-content .author-list{padding-right:12px}.article-byline-meta .author-name{margin-bottom:4px}}.footer-cta{position:relative;text-align:center}.footer-cta-title{font-size:clamp(2.6rem,5vw,3.8rem);font-weight:800;margin:0 0 min(24px,6.4vmin)}.footer-cta-button{align-items:center;background:#fff;border:1px solid var(--color-border);border-radius:8px;color:var(--color-secondary-text);display:inline-flex;font-size:1.7rem;justify-content:space-between;max-width:500px;padding:5px 5px 5px 15px;position:relative;transition:border-color .2s;width:100%}.footer-cta-button:hover{border-color:#c2c2c2}.footer-cta-button span{background:var(--ghost-accent-color);border-radius:6px;color:#fff;display:inline-block;font-size:1.6rem;font-weight:600;letter-spacing:-.005em;padding:9px 15px}.footer-cta+.read-more-wrap{margin-top:max(12vmin,72px)}.read-more{grid-gap:4vmin;display:grid;grid-template-columns:repeat(6,1fr)}@media (max-width:1000px){.read-more{grid-template-columns:repeat(4,1fr)}.read-more .post-card:nth-child(3){display:none}}@media (max-width:700px){.read-more{grid-template-columns:repeat(2,1fr)}.read-more .post-card:nth-child(2){display:none}}@media (min-width:1001px){}@media (min-width:1001px){}@media (min-width:940px){}@media (max-width:800px){}@media (max-width:500px){}.site-footer{background:#0a0b0c;color:#fff;margin:max(12vmin,64px)0 0;padding-bottom:140px;padding-top:48px;position:relative}.site-footer .inner{grid-gap:40px;color:hsla(0,0%,100%,.7);display:grid;font-size:1.3rem;grid-template-columns:auto 1fr auto}.site-footer .copyright a{color:#fff;font-weight:500;letter-spacing:-.015em}.site-footer a{color:hsla(0,0%,100%,.7)}.site-footer a:hover{color:#fff;text-decoration:none}@media (max-width:767px){.site-footer .inner{grid-gap:0;grid-template-columns:1fr;max-width:500px;text-align:center}.site-footer .copyright,.site-footer .copyright a{color:#fff;font-size:1.5rem}.site-footer .copyright{margin-bottom:16px}}:where(html.dark-mode) .gh-content a{color:#fff}@media (max-width:767px){}@media (prefers-color-scheme:dark){:where(html.auto-color) .gh-content a{color:#fff}@media (max-width:767px){}}@media (-webkit-min-device-pixel-ratio:1.09375),(-webkit-min-device-pixel-ratio:1.1),(min-resolution:1.1dppx),(min-resolution:105dpi){}@media screen and (max-width:1024px){}@-webkit-keyframes clockwise{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@keyframes clockwise{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}@-webkit-keyframes donut-rotate{0%{transform:rotate(0)}50%{transform:rotate(-140deg)}to{transform:rotate(0)}}@keyframes donut-rotate{0%{transform:rotate(0)}50%{transform:rotate(-140deg)}to{transform:rotate(0)}}</style>
<link rel=canonical href=https://www.crustofcode.com/how4/>
<link rel=amphtml href=https://www.crustofcode.com/how4/amp/>
<meta property=og:site_name content="A crust of code">
<meta property=og:type content=article>
<meta property=og:title content="The How of Macros 4: `quote`">
<meta property=og:description content="When the Elixir parser sees quote do: content, it produces a 3-tuple of the form 
{:quote, metadata, [[do: content]]}. 

Marick takes a deep breath.

:quote is a special form that takes the abstract syntax tree content (which
represents Elixir code) and turns it into an abstract syntax tree for literal">
<meta property=og:url content=https://www.crustofcode.com/how4/>
<meta property=article:published_time content=2021-07-06T22:30:18.000Z>
<meta property=article:modified_time content=2021-07-12T23:29:04.000Z>
<meta property=article:tag content=macros>
<meta property=article:tag content=compilation>
<meta property=article:tag content=elixir>
<meta name=twitter:card content=summary_large_image>
<meta name=twitter:title content="The How of Macros 4: `quote`">
<meta name=twitter:description content="`quote` uses the literal-data handling described in the last post to recreate a syntax tree. It's involuted!">
<meta name=twitter:url content=https://www.crustofcode.com/how4/>
<meta name=twitter:image content=https://www.crustofcode.com/content/images/2021/07/Screen-Shot-2021-07-06-at-17.22.23.png>
<meta name=twitter:label1 content="Written by">
<meta name=twitter:data1 content=marick>
<meta name=twitter:label2 content="Filed under">
<meta name=twitter:data2 content="macros, compilation, elixir">
<meta name=twitter:site content=@marick>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","publisher":{"@type":"Organization","name":"A crust of code","url":"https://www.crustofcode.com/","logo":{"@type":"ImageObject","url":"https://www.crustofcode.com/favicon.ico","width":48,"height":48}},"author":{"@type":"Person","name":"marick","url":"https://www.crustofcode.com/author/marick/","sameAs":[]},"headline":"The How of Macros 4: &#x60;quote&#x60;","url":"https://www.crustofcode.com/how4/","datePublished":"2021-07-06T22:30:18.000Z","dateModified":"2021-07-12T23:29:04.000Z","keywords":"macros, compilation, elixir","description":"When the Elixir parser sees quote do: content, it produces a 3-tuple of the form \n{:quote, metadata, [[do: content]]}. \n\nMarick takes a deep breath.\n\n:quote is a special form that takes the abstract syntax tree content (which\nrepresents Elixir code) and turns it into an abstract syntax tree for literal\ndata that, when compiled, creates the abstract syntax tree that represents the\nElixir code. \n\nPerhaps I should explain more slowly.\n\nThe series: Elixir compilation [https://www.crustofcode.com/how","mainEntityOfPage":"https://www.crustofcode.com/how4/"}</script>
<meta name=generator content="Ghost 5.89">
<link rel=alternate type=application/rss+xml title="A crust of code" href=https://www.crustofcode.com/rss/>
<link href=https://www.crustofcode.com/webmentions/receive/ rel=webmention>
<style>@media (max-width:640px){}@media (max-width:640px){}@media (max-width:640px){}@media (max-width:400px){}@media (max-width:800px){}@media (max-width:600px){}@media (max-width:767px){}@media (min-width:640px){}@media (min-width:1024px){}@media (min-width:1280px){}@media (min-width:1024px){}@media (min-width:640px){}@media (min-width:1024px){}@media (min-width:640px){}@media (min-width:1024px){}@media (min-width:1280px){}@media (max-width:600px){}@media (max-width:640px){}@media (max-width:640px){}@media (max-width:400px){}@media (max-width:640px){}@media (max-width:520px){}@media (max-width:520px){}@media (max-width:520px){}@media (max-width:300px){}</style>
<style>:root{--ghost-accent-color:#15171A}</style>
<style>pre{-moz-hyphens:none;-ms-hyphens:none;-webkit-hyphens:none}</style>
<style>code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:0 0;text-shadow:0 1px rgba(0,0,0,.3);font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto;border-radius:.3em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#272822}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.comment{color:#708090}.token.punctuation{color:#f8f8f2}.token.symbol{color:#f92672}.token.number{color:#ae81ff}.token.attr-name{color:#a6e22e}.token.operator{color:#f8f8f2}.token.keyword{color:#66d9ef}</style>
<style>@media (max-width:390px){}@media (max-width:340px){}@media (max-width:480px){}</style><style>@media (prefers-reduced-motion:no-preference){}@keyframes App-logo-spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}</style><meta name=referrer content=no-referrer><link type=image/x-icon rel="shortcut icon" href="data:image/x-icon;base64,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Ff8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf9eW1r/+/v7//7+/v9cWln/GhcV/xoXFf8aFxX/GhYVzRkWFekaFxX/GhcV/xoXFf+uraz//////+Xl5P8dGhj/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf+hoJ///////66trP8aFxX/GhcV/xoXFf8aFhTjGhcV9RoXFf8aFxX/HRoY/+jo5///////ubi3/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/z07Of/9/f3/6Ojo/x0aGP8aFxX/GhcV/xkWFPEaFxX8GhcV/xoXFf8yLy3//Pz8//////+npaX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/HBkX/+Pj4//8/Pz/Mi8t/xoXFf8aFxX/GhYU+hoXFf8aFxX/GhcV/0RCQP/+/v7//////7e2tf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/0tHR//7+/v9EQkD/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/RkRC////////////4eHg/xwZF/8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xwZF//j4+L//////0ZDQf8aFxX/GhcV/xoXFf8ZFhX7GhcV/xoXFf83NDL//fz8///////8/Pz/NTMx/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/PTs5//39/f/9/f3/NzQy/xoXFf8aFxX/GRYU+xkXFfQaFxX/GhcV/yAdG//w7+////////////9cWlj/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoX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Ff8lIiD/fn17/97e3f/4+Pj////////////////////////////////////////////////////////////////////////////4+Pj/3d3d/399fP8lIiD/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFKogAAAIAAAAAAAAAAAaFhZFGhcV6xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GxgW/z47Of+0s7L/+/v7/////////////v7+//b29v/o5+f/19bW/8XExP++vbz/w8LB/9bV1f/p6Oj/9/f3//7+/v////////////////////////////r6+v+ysbD/PTo5/xsYFv8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFeUZGRQzAAAAADMAAAUaFhSBGRYV+xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8dGhj/W1lY/8/Pzv/9/f3///////7+/v/r6+r/rq6t/3Vzc/9JRkX/Lisp/yMgH/8gHRv/Ih8d/y0qKf9LSUf/enl4/7a1tf/u7e3//v7+///////////////////////9/f3/zs7N/1tZV/8dGhj/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFfcZFxVvAAAAAhwcDhIaFxSzGhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xwZF/9eW1r/4eHh/////////////v7+/8fHxv9TUE//JyQi/xsYFv8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/HBkX/ykmJf9XVVP/vLu6//z7+////////////////////////////+Hh4f9eW1r/HBkX/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf4ZFhSiFRUVDBcXFyEaFxXcGhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/0NBP//W1dX////////////x8fH/lZST/yMgHv8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/HRoY/2BeXf/Ly8r/9/f3///////////////////////V1dX/Q0A//xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFhTNHBMTGxkVFT0ZFhXzGhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/LSsp/8DAv//+/v7///////Hx8f+EgoH/JCEf/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xsYFv80MS//goF//9zc2//+/v7////////////+/v7/wcC//y0qKP8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxXrFRUVMBgVE18aFxX9GhcV/xoXFf8aFxX/GhcV/xoXFf8eGxn/lpSU//39/f///////v7+/5iXlv8kISD/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/HhsZ/0RBP/+7urr//Pz8/////////////f39/5iXlv8eGxn/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFhT6FxcUTRkXFYYaFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf9PTUv/6Ojo///////+/v7/ycjH/yQhIP8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8uKyn/qKem//j4+P///////////+jo5/9QTkz/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GRYUchoXFqYaFxX/GhcV/xoXFf8aFxX/GhcV/yIfHf+bmpn//Pz8///////u7e3/WFZU/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/JiMh/5SSkf/29vb///////z8/P+cm5r/IyAe/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhYUlhkWFMEaFxX/GhcV/xoXFf8aFxX/GhcV/zg1M//b29r////////+/v+3trX/KScl/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/yonJv+sqqr//f39///////b29v/ODU0/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcUtBkVFNYaFxX/GhcV/xoXFf8aFxX/GhcV/2loZv/7+/v///////n5+f+Afn3/HBkX/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf9IRkT/4uHh///////7+/r/amdm/xoXFf8aFxX/GhcV/xoXFf8aFxX/GRUUyxoWFOUaFxX/GhcV/xoXFf8aFxX/GxgW/6+trf///////////+7u7v9bWVf/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8dGxn/l5aV////////////sK+u/xsYFv8aFxX/GhcV/xoXFf8aFxX/GRYV3xkWFfEaFxX/GhcV/xoXFf8aFxX/IR4c/+Xl5P///////////+Xl5f9APj3/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/QT89//n5+f//////5uXl/yEeHP8aFxX/GhcV/xoXFf8aFxX/GRYU6xoXFfcaFxX/GhcV/xoXFf8aFxX/Ojc1//n5+f///////////+Lh4f81MjH/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/Hxwa/9va2v//////+fn5/zo4Nv8aFxX/GhcV/xoXFf8aFxX/GRYU9BoXFf8aFxX/GhcV/xoXFf8aFxX/VFJQ//z8/P///////////+Li4v84NTP/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GxgW/7y7uv///////Pz8/1RSUP8aFxX/GhcV/xoXFf8aFxX/GhcV/BoXFf8aFxX/GhcV/xoXFf8aFxX/Y2Fg/////////////////+no6P9KSEb/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/7Szsv///////////2RiYf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/ZmNh//////////////////Ly8v9oZmX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/HBkY/8fHx////////////2VjYf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf4aFxX/GhcV/xoXFf8aFxX/WlhW//39/f////////////v7+/+Mion/HRsZ/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/LCkn/+vr6////////f39/1pXVv8aFxX/GhcV/xoXFf8aFxX/GhcV/hoXFfYaFxX/GhcV/xoXFf8aFxX/Q0E///r6+v////////////7+/v+uraz/JiMh/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/aGZl//39/f//////+vr6/0RBP/8aFxX/GhcV/xoXFf8aFxX/GhcV9hoWFO8aFxX/GhcV/xoXFf8aFxX/JyQi/+/v7//////////////////JyMf/Liwq/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8lIyH/vby7////////////7+/u/yUjIf8aFxX/GhcV/xoXFf8aFxX/GhYU8BkWFOMaFxX/GhcV/xoXFf8aFxX/HRoY/8HAv//////////////////e3t3/NzQy/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xsYFv9iYF7/7u7t////////////wMC//xwZF/8aFxX/GhcV/xoXFf8aFxX/GRcU4hkWFdIaFxX/GhcV/xoXFf8aFxX/GhcV/358ev/+/v7////////////y8vL/T0xK/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/ywpJ/+7urn//v7+///////+/v7/fXx7/xoXFf8aFxX/GhcV/xoXFf8aFxX/GRYT0hgWFLwaFxX/GhcV/xoXFf8aFxX/GhcV/0RCQf/p6en/////////////////gH9+/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/HRoY/4GAfv/6+vr////////////o6Oj/Q0FA/xoXFf8aFxX/GhcV/xoXFf8aFxX/GBYUvBoWFZ8aFxX/GhcV/xoXFf8aFxX/GhcV/yclI/+xsK///v7+////////////zs3N/yQhH/8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8cGRf/YV9e/+3t7f////////////7+/v+wr67/JyQi/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhYVoBgWFH4aFxX/GhcV/xoXFf8aFxX/GhcV/xsYFv9oZmT/8fHx////////////+/v7/21rav8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf9JR0X/2tnZ//////////////////Hx8f9nZWP/GxgW/xoXFf8aFxX/GhcV/xoXFf8aFxX/GBYUfhgYFVYaFxX9GhcV/xoXFf8aFxX/GhcV/xoXFf8nJCL/ubm3/////////////////9TT0/83NTP/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/zEuLP+5uLf//v7+/////////////////7i4t/8mIyH/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX9GhcUWRcTEzcaFhTvGhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/REE//9/f3/////////////n5+f+hoJ//Kigm/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/LSoo/6Sjo//5+fn/////////////////397e/0RBP/8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFhTwFxcTNxoRER4aFxTVGhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GxgW/2JfXv/t7e3////////////39vb/paSj/yYjIf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf81MjD/tLOz//v7+//////////////////s7Oz/YV9d/xsYFv8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxTWGhoRHiIREQ8ZFhWrGhcV/hoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/yAdG/+Eg4L/8vLy/////////////v7+/8vKyv9WU1L/JyQj/xsYFv8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aGBX/IyEf/1BOTP/Ix8f//f39//////////////////Ly8v+EgoL/IB0b/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8ZFhWsIhERDwAAAAQZFRV5GhcU+RoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8mIyH/hIKC/+zs7P////////////7+/v/r6+v/sbCv/3Rycf9DQD//JiMh/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/yYkIv9WU1L/oJ+e/+rp6f//////////////////////7e3t/4SDgv8mIyH/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFPkZFRV5AAAABAAAAAAZFRU9GhcV6BoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/IB0b/2BeXP/e3d3//////////////////v7+//b19f/l5OT/ycnI/6Sjov94d3X/WVdV/0xKSP9cWVj/iIeG/8fGxf/r6+r//Pz8///////////////////////f3t7/YV9d/yAdG/8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFegZFRU9AAAAAAAAAAAXFxcLGhcVsxoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xsYFv9EQT//uLi3//Hx8P/+/v7//////////////////////////////////f39//v7+//9/f3////////////////////////////+/v7/8fHx/7i4t/9EQT//GxgW/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xkWFbYXFxcLAAAAAAAAAAAAAAAAGBQUQBoXFfIaFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/JiMh/2ZkYv+wr67/6Ojo//7+/v///////////////////////////////////////////////////////v7+/+np6f+xsK//aGZk/yYjIf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhcV/xoXFf8aFxX/GhYV8BoWEkUAAAAAAAAAAAAAAAAAAAAAAAAAAxoX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"><style>.sf-hidden{display:none!important}</style><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;"><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style><body class="post-template tag-macros tag-compilation tag-elixir is-head-left-logo has-cover is-dropdown-loaded"><div style=display:block;opacity:1;color-scheme:light><template shadowrootmode=open><iframe allowtransparency=true frameborder=0 scrolling=no class=sk_ui title=Surfingkeys style=position:fixed;left:0px;bottom:0px;width:100%;height:0px;z-index:2147483647></iframe></template></div>
<div class=viewport>
 <header id=gh-head class="gh-head outer">
 <div class="gh-head-inner inner">
 <div class=gh-head-brand>
 <a class="gh-head-logo no-image" href=https://www.crustofcode.com/>
 A crust of code
 </a>
 <button class="gh-search gh-icon-btn sf-hidden" aria-label="Search this site" data-ghost-search><svg xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24" stroke=currentColor stroke-width=2 width=20 height=20><path stroke-linecap=round stroke-linejoin=round d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
 <button class="gh-burger sf-hidden" aria-label="Main Menu"></button>
 </div>
 <nav class=gh-head-menu>
 <ul class=nav>
 <li class=nav-home><a href=https://www.crustofcode.com/>Home</a></li>
 <li class=nav-subscribe-rss><a href=https://www.crustofcode.com/rss/>Subscribe (RSS)</a></li>
</ul>
 </nav>
 <div class=gh-head-actions>
 <button class="gh-search gh-icon-btn" aria-label="Search this site" data-ghost-search><svg xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24" stroke=currentColor stroke-width=2 width=20 height=20><path stroke-linecap=round stroke-linejoin=round d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
 <div class=gh-head-members>
 <a class="gh-head-link gh-portal-close" href=#/portal/signin data-portal=signin>Sign in</a>
 <a class="gh-head-button gh-portal-close" href=#/portal/signup data-portal=signup>Subscribe</a>
 </div>
 </div>
 </div>
 </header>
 <div class=site-content>
 
<main id=site-main class=site-main>
<article class="article post tag-macros tag-compilation tag-elixir no-image">
 <header class="article-header gh-canvas">
 <div class="article-tag post-card-tags">
 <span class=post-card-primary-tag>
 <a href=https://www.crustofcode.com/tag/macros/>macros</a>
 </span>
 </div>
 <h1 class=article-title>The How of Macros 4: `quote`</h1>
 <div class=article-byline>
 <section class=article-byline-content>
 <ul class="author-list instapaper_ignore">
 <li class=author-list-item>
 <a href=https://www.crustofcode.com/author/marick/ class="author-avatar author-profile-image" aria-label="Read more of marick"><svg viewBox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><g fill=none fill-rule=evenodd><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill=#FFF></path></g></svg>
</a>
 </li>
 </ul>
 <div class=article-byline-meta>
 <h4 class=author-name><a href=https://www.crustofcode.com/author/marick/>marick</a></h4>
 <div class=byline-meta-content>
 <time class=byline-meta-date datetime=2021-07-06>Jul 6, 2021</time>
 <span class=byline-reading-time><span class=bull>â€¢</span> 3 min read</span>
 </div>
 </div>
 </section>
 </div>
 </header>
 <section class="gh-content gh-canvas">
 <p>When the Elixir parser sees <code>quote do: <em>content</em></code>, it produces a 3-tuple of the form <code>{:quote, <em>metadata, </em>[[do:<em> content</em>]]}</code><em>.</em> <p><em>Marick takes a deep breath.</em><p><code>:quote</code> is a special form that takes the abstract syntax tree <em><code>content</code> </em>(which represents Elixir code) and turns it into an abstract syntax tree for literal data that, when compiled, creates the abstract syntax tree that represents the Elixir code. <p>Perhaps I should explain more slowly.<p><strong>The series:</strong> <a href=https://www.crustofcode.com/how1/>Elixir compilation</a>, <a href=https://www.crustofcode.com/how-2/>syntax trees</a>, <a href=https://www.crustofcode.com/how3/>literal data</a>, <code><a href=https://www.crustofcode.com/how4/>quote</a></code>, <code><a href=https://www.crustofcode.com/how5/>unquote</a></code>, <code>escape</code>, hygiene and <code>var</code>, what's up with <code>require</code>?<hr><p>Let's start by considering bytecode generation in a bit more detail, starting with the syntax tree for this expression:<pre class=language-elixir><code class=language-elixir>elem <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token operator">+</span>a<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> which</code></pre><p>... which is:<pre class=language-elixir><code class=language-elixir><span class="token punctuation">{</span><span class="token atom symbol">:elem</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token attr-name">context:</span> Elixir<span class="token punctuation">,</span> <span class="token attr-name">import:</span> Kernel<span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">[</span>
   <span class="token punctuation">{</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
    <span class="token punctuation">[</span>
      <span class="token number">1</span><span class="token punctuation">,</span> 
      <span class="token punctuation">{</span>:<span class="token operator">+</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token attr-name">context:</span> Elixir<span class="token punctuation">,</span> <span class="token attr-name">import:</span> Kernel<span class="token punctuation">]</span><span class="token punctuation">,</span> 
       <span class="token punctuation">[</span>
         <span class="token number">100</span><span class="token punctuation">,</span>
         <span class="token punctuation">{</span><span class="token atom symbol">:a</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Elixir<span class="token punctuation">}</span>
       <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> 
      <span class="token number">3</span>
    <span class="token punctuation">]</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span> 
   <span class="token punctuation">{</span><span class="token atom symbol">:which</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Elixir<span class="token punctuation">}</span>
 <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><p>Bytecode generation linearizes this tree into a list of step-by-step instructions, starting from the bottom up (or leaves inward). That is, the generated bytecodes will first add the value of <code>a</code> to <code>100</code>. Then they will use the result of that, together with <code>1</code> and <code>3</code>, to form a 3-tuple. They will finally call <code>elem</code> with the 3-tuple and the value of <code>which</code> as arguments.<p>And here's an example of the bytecodes in action:<pre class=language-elixir><code class=language-elixir>iex<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> a <span class="token operator">=</span> <span class="token number">899</span>; which <span class="token operator">=</span> <span class="token number">1</span>

iex<span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> elem <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token operator">+</span>a<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> which
<span class="token number">999</span>
</code></pre><p>Now, let's add a twist and apply <code>elem</code> to some quoted Elixir text:<pre class=language-elixir><code class=language-elixir>iex<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> elem <span class="token punctuation">(</span>quote <span class="token attr-name">do:</span> inspect a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span>
<span class="token atom symbol">:inspect</span>

iex<span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> elem <span class="token punctuation">(</span>quote <span class="token attr-name">do:</span> inspect a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token attr-name">context:</span> Elixir<span class="token punctuation">,</span> <span class="token attr-name">import:</span> Kernel<span class="token punctuation">]</span>

iex<span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> elem <span class="token punctuation">(</span>quote <span class="token attr-name">do:</span> inspect a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span>
<span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token atom symbol">:a</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Elixir<span class="token punctuation">}</span><span class="token punctuation">]</span></code></pre><p><code>elem</code> is working on the syntax tree, not on the result of compiling and executing that syntax tree. But remember that the syntax tree is a <em>literal</em> structure of nested 3-tuples. As you saw in the previous post, literal structures of that sort aren't stored anywhere for use during bytecode execution; rather, bytecode execution <em>creates</em> them. So what has to happen is:<ol><li>The <code>quote</code> special form takes a syntax tree. <li>It must transform that syntax tree into a <em>new</em> syntax tree.<li>That syntax tree is compiled into bytecodes into the normal way. Those bytecodes, when executed, build the original syntax tree.<li>After that execution, more bytecodes are executed to <code>apply</code> <code>elem</code> to the syntax tree.</ol><p>Let's go through that for our example. <h3 id=the-starting-syntax-tree>The starting syntax tree</h3>
<p>The full parse tree for the <code>elem</code> example is this:<pre class=language-elixir><code class=language-elixir><span class="token punctuation">{</span><span class="token atom symbol">:elem</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token attr-name">context:</span> Elixir<span class="token punctuation">,</span> <span class="token attr-name">import:</span> Kernel<span class="token punctuation">]</span><span class="token punctuation">,</span>
 <span class="token punctuation">[</span>
   <span class="token punctuation">{</span><span class="token atom symbol">:quote</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token attr-name">context:</span> Elixir<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span>
      <span class="token punctuation">[</span><span class="token attr-name">do:</span> 
        <span class="token punctuation">{</span><span class="token atom symbol">:inspect</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token attr-name">context:</span> Elixir<span class="token punctuation">,</span> <span class="token attr-name">import:</span> Kernel<span class="token punctuation">]</span><span class="token punctuation">,</span> 
         <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token atom symbol">:a</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Elixir<span class="token punctuation">}</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
   <span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token number">0</span>
  <span class="token punctuation">]</span>
 <span class="token punctuation">}</span>
</code></pre><p>Before the bytecode generator generates bytecodes (from the bottom up), it first <strong>context-expands</strong> the tree, which happens from the top down. A lot of what happens in this phase is error checking that can't be done during parsing because it depends on understanding context. For example, this is invalid:<pre class=language-elixir><code class=language-elixir>  <span class="token keyword">def</span> foo<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token attr-name">do:</span> <span class="token operator">^</span>a
</code></pre><p>... because pinned variables must be within a pattern. However, the parser doesn't keep track of where <code>^a</code> is found; it just translates it into <code>{:^, [], [{:a, [], Elixir}]}</code>. So the error is checked for during context-expansion.<p>Such checking is best finished before bytecode generation starts so that the actual generator can be sure it's working with a fully valid syntax tree.<p>(This separation of concerns is typical in compilers. <a href="https://en.wikipedia.org/wiki/Context-free_grammar?ref=crustofcode.com">Context-free parsing</a> is easily automatable, but <a href="https://en.wikipedia.org/wiki/Context-sensitive_grammar?ref=crustofcode.com">context sensitivity</a> most usually requires custom code that's best written as a postprocessing step.)<h3 id=the-new-syntax-tree>The new syntax tree</h3>
<p>In addition to checking, the top-down processing also handles a <code>:quote</code> special form specially. Roughly speaking, it's handled by a function like this:<pre class=language-elixir><code class=language-elixir>  <span class="token keyword">def</span> expand<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token atom symbol">:quote</span><span class="token punctuation">,</span> _metadata<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token attr-name">do:</span> body<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    do_quote<span class="token punctuation">(</span>body<span class="token punctuation">)</span>
  <span class="token keyword">end</span>
</code></pre><p><code>do_quote</code> then handles the various different "shapes" of syntax trees. In our case, the top of the tree is a 3-tuple representing a call to <code>inspect</code>, which would be handled by this function:<pre class=language-elixir><code class=language-elixir>  <span class="token keyword">def</span> do_quote<span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">,</span> metadata<span class="token punctuation">,</span> args<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">when</span> is_list<span class="token punctuation">(</span>args<span class="token punctuation">)</span> <span class="token keyword">do</span>
    expanded <span class="token operator">=</span> <span class="token keyword">for</span> arg <span class="token operator">&lt;-</span> args<span class="token punctuation">,</span> <span class="token attr-name">do:</span> do_quote<span class="token punctuation">(</span>arg<span class="token punctuation">)</span>
    <span class="token punctuation">{</span> :<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> metadata<span class="token punctuation">,</span> expanded <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
</code></pre><p>Because of the <code>for</code>, <code>do_quote</code> is applied to a variable; that is, to this 3-tuple: <code>{:a, [], Elixir}</code>. That processing can be described by this function:<pre class=language-elixir><code class=language-elixir>  <span class="token keyword">def</span> do_quote<span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">,</span> metadata<span class="token punctuation">,</span> where<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token keyword">when</span> is_atom<span class="token punctuation">(</span>where<span class="token punctuation">)</span> <span class="token keyword">do</span>
    <span class="token punctuation">{</span> :<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> metadata<span class="token punctuation">,</span> where <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
</code></pre><p>(<a href="https://github.com/elixir-lang/elixir/blob/master/lib/elixir/src/elixir_quote.erl?ref=crustofcode.com">The code</a> is actually written in Erlang, not Elixir.)<p>When the <code>:quote</code> tree is processed the result is this:<pre class=language-elixir><code class=language-elixir><span class="token punctuation">{</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
 <span class="token punctuation">[</span>
   <span class="token atom symbol">:inspect</span><span class="token punctuation">,</span> 
   <span class="token punctuation">[</span><span class="token attr-name">context:</span> Elixir<span class="token punctuation">,</span> <span class="token attr-name">import:</span> Kernel<span class="token punctuation">]</span><span class="token punctuation">,</span> 
   <span class="token punctuation">[</span>
     <span class="token punctuation">{</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token atom symbol">:a</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Elixir<span class="token punctuation">]</span><span class="token punctuation">}</span>
   <span class="token punctuation">]</span>
 <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre><p>Since <code>expand</code> works top down, that expanded syntax tree is then embedded within the full parse tree, giving us this:<pre class=language-elixir><code class=language-elixir><span class="token punctuation">{</span><span class="token atom symbol">:elem</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token attr-name">context:</span> Elixir<span class="token punctuation">,</span> <span class="token attr-name">import:</span> Kernel<span class="token punctuation">]</span><span class="token punctuation">,</span> 
  <span class="token punctuation">[</span> 
    <span class="token comment"># start result of `quote`</span>
    <span class="token punctuation">{</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> 
     <span class="token punctuation">[</span>
       <span class="token atom symbol">:inspect</span><span class="token punctuation">,</span> 
       <span class="token punctuation">[</span><span class="token attr-name">context:</span> Elixir<span class="token punctuation">,</span> <span class="token attr-name">import:</span> Kernel<span class="token punctuation">]</span><span class="token punctuation">,</span> 
       <span class="token punctuation">[</span>
         <span class="token punctuation">{</span>:<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token atom symbol">:a</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Elixir<span class="token punctuation">]</span><span class="token punctuation">}</span>         <span class="token comment"># line 9</span>
       <span class="token punctuation">]</span>
     <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment"># end result of `quote`</span>
    <span class="token number">0</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre><h3 id=bytecode-generation>Bytecode generation</h3>
<p>Since code generation is (roughly) bottom up, the first bytecodes are generated from the <code>:{}</code> expression on line 9, and they are bytecodes that produce the tuple <code>{:a, [], Elixir}</code>. <p>The next set of bytecodes generated will combine that result with <code>:inspect</code> and the metadata keyword list (which contains only atoms) to produce this:<pre class=language-elixir><code class=language-elixir><span class="token punctuation">{</span><span class="token atom symbol">:inspect</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token attr-name">context:</span> Elixir<span class="token punctuation">,</span> <span class="token attr-name">import:</span> Kernel<span class="token punctuation">]</span><span class="token punctuation">,</span> 
 <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token atom symbol">:a</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Elixir<span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre><p>Ta-da! A roundabout journey, but we've managed to create the literal syntax tree for the original <code>inspect a</code>.<p>Abstractly, we can think of the bytecode generator as now creating &nbsp;the bytecodes to <code>apply</code> <code>elem</code> to that recreated literal syntax tree and <code>0</code>. In actuality, fetching tuple elements is so common that there's a special bytecode for it. So it happens without the expense of a function call. <hr><p>That's all well and good, but it's rare to see a <code>quote</code> expression without an <code>unquote</code> within it. How does that work? Read on.<p>Previous: <a href=https://www.crustofcode.com/how3/>Syntax trees for literal data</a><br>Next: <code><a href=https://www.crustofcode.com/how5/>unquote</a></code><p></p>
 </section>
</article>
</main>
 <section class="footer-cta outer">
 <div class=inner>
 <h2 class=footer-cta-title>Sign up for more like this.</h2>
 <a class="footer-cta-button gh-portal-close" href=#/portal data-portal>
 <div class=footer-cta-input>Enter your email</div>
 <span>Subscribe</span>
 </a>
 </div>
 </section>
 <aside class="read-more-wrap outer">
 <div class="read-more inner">
 
<article class="post-card post no-image">
 <div class=post-card-content>
 <a class=post-card-content-link href=https://www.crustofcode.com/i-got-lucky-com/>
 <header class=post-card-header>
 <div class="post-card-tags sf-hidden">
 </div>
 <h2 class=post-card-title>
 i-got-lucky.com
 </h2>
 </header>
 <div class=post-card-excerpt>Just thought of creating i-got-lucky.com, where successful people could describe how it wasnâ€™t just their virtues that gave them success. They could describe how much sheer luck mattered.
It might be useful because an amazing number of people donâ€™t believe luck played a part in their success.</div>
 </a>
 <footer class=post-card-meta>
 <time class=post-card-meta-date datetime=2023-02-16>Feb 16, 2023</time>
 <span class=post-card-meta-length>3 min read</span>
 </footer>
 </div>
</article>
 
<article class="post-card post no-image">
 <div class=post-card-content>
 <a class=post-card-content-link href=https://www.crustofcode.com/more-on-the-definition-of-boundary-object/>
 <header class=post-card-header>
 <div class="post-card-tags sf-hidden">
 </div>
 <h2 class=post-card-title>
 More on the definition of "boundary object"
 </h2>
 </header>
 <div class=post-card-excerpt>The very first episode of Oddly Influenced was about Star &amp; Griesemer's idea of "boundary objects." That's proven to be a fairly hard concept to pin down, and I did at best an average job. Fortunately, I'm rereading Ã‰tienne Wenger's</div>
 </a>
 <footer class=post-card-meta>
 <time class=post-card-meta-date datetime=2023-01-02>Jan 2, 2023</time>
 <span class=post-card-meta-length>4 min read</span>
 </footer>
 </div>
</article>
 
<article class="post-card post no-image">
 <div class=post-card-content>
 <a class=post-card-content-link href=https://www.crustofcode.com/tinkerable-software-and-mastodon/>
 <header class=post-card-header>
 <div class="post-card-tags sf-hidden">
 </div>
 <h2 class=post-card-title>
 Tinkerable software and Mastodon
 </h2>
 </header>
 <div class=post-card-excerpt>More than 20 years ago, I wrote an editorial proposing what I called tinkerable software.
We expect houses to be tinkerable: ordinary people, not the original builders, can modify them in both small and large ways. Even those who don't want to tinker expect tinkerability from physical products.</div>
 </a>
 <footer class=post-card-meta>
 <time class=post-card-meta-date datetime=2022-12-29>Dec 29, 2022</time>
 <span class=post-card-meta-length>3 min read</span>
 </footer>
 </div>
</article>
 </div>
 </aside>
 </div>
 <footer class="site-footer outer">
 <div class=inner>
 <section class=copyright><a href=https://www.crustofcode.com/>A crust of code</a> Â© 2024</section>
 <nav class=site-footer-nav>
 
 </nav>
 <div class=gh-powered-by><a href=https://ghost.org/ target=_blank rel=noopener>Powered by Ghost</a></div>
 </div>
 </footer>
</div>
 <div class="pswp sf-hidden" tabindex=-1 role=dialog aria-hidden=true>
 
 
</div>
 
 
 
 
 
 
<div id=ghost-portal-root></div><div id=sodo-search-root></div><script data-template-shadow-root>(()=>{document.currentScript.remove();processNode(document);function processNode(node){node.querySelectorAll("template[shadowrootmode]").forEach(element=>{let shadowRoot = element.parentElement.shadowRoot;if (!shadowRoot) {try {shadowRoot=element.parentElement.attachShadow({mode:element.getAttribute("shadowrootmode")});shadowRoot.innerHTML=element.innerHTML;element.remove()} catch (error) {} if (shadowRoot) {processNode(shadowRoot)}}})}})()</script>